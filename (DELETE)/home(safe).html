<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCSS to JSON Converter</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        textarea { width: 100%; height: 200px; }
        pre { background-color: #f5f5f5; padding: 10px; border-radius: 5px; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; }
        .flexi { display: flex; flex-direction: row; justify-content: space-around; }
        .row { display: flex; flex-direction: row; }
        .column { display: flex; flex-direction: column; }
        .justi-align {  justify-content: center; align-items: center; }
    </style>
</head>
<body>

    <h1>SCSS Cleaner</h1>
    <hr>
    <h2>SCSS input:</h2>
    <textarea id="scssInput" placeholder="Please paste your SCSS Themes content here"></textarea>
    <div class="flexi row justi-align">
        <div class="column">
            <label for="activeTheme">Active Theme:</label>
            <input type="text" id="activeTheme" value="peter">
        </div>
        <div class="column">
            <label for="multiplayer">Multiplier:</label>
            <input type="number" id="multiplayer" value="1">
        </div>
        <div class="column">
            <label for="vintageOn">Vintage On:</label>
            <input type="checkbox" id="vintageOn" ${vintageOn ? 'checked' : ''}>
        </div>
        <div class="column">
            <label for="balancer">Balancer:</label>
            <input type="number" id="balancer" value="200">
        </div>
    </div>
    <button id="convertButton" onclick="viewCleanScss()">Clean File</button>
    
    <hr>

    <div class="flexi column">
            <h2>Clean version of your SCSS:</h2>
            <button>copy to clipboard</button>
            <pre id="cleanScssOutput"></pre>
    </div>

    <hr>


    <!-- <script src="./index2.js"></script> -->
    <script>
        let themes = {
            regular: { darkner: [4, 4, 4], midtones: [15, 76, 162], lightner: [218, 218, 218] },
            regular2: { darkner: [5, 59, 62], midtones: [65, 149, 175], lightner: [255, 232, 99] },
            free_spirit: { darkner: [0, 0, 0], midtones: [47, 160, 86], lightner: [236, 236, 236] },
            kartoffel: { darkner: [0, 0, 0], midtones: [179, 40, 40], lightner: [255, 186, 49] },
            sweater: { darkner: [25, 20, 20], midtones: [95, 120, 150], lightner: [230, 210, 170] },
            avocado: { darkner: [35, 25, 10], midtones: [120, 140, 80], lightner: [245, 230, 160] },
            berries: { darkner: [40, 30, 35], midtones: [150, 100, 120], lightner: [230, 220, 200] },
            cappuccino_choco: { darkner: [68, 48, 32], midtones: [135, 100, 85], lightner: [230, 215, 185] },
            brownies: { darkner: [45, 30, 20], midtones: [120, 85, 60], lightner: [215, 190, 150] },
            peter: { darkner: [1, 1, 1], midtones: [86, 86, 86], lightner: [255, 255, 0] }
        };
        // function parseScssThemes(scss) {
        //     const themeRegex = /\$themes:\s*\(\s*([^;]+?)\s*\);/s;
        //     const match = scss.match(themeRegex);
        //     if (!match) return {};

        //     const themeString = match[1];
        //     const themeEntries = themeString.split(/\),\s*/).map(entry => entry.trim() + ')');

        //     let extractedThemes = {};
        //     themeEntries.forEach(entry => {
        //         const themeMatch = entry.match(/(\w+):\s*\(\s*darkner:\s*\(([^)]+)\),\s*midtones:\s*\(([^)]+)\),\s*lightner:\s*\(([^)]+)\)\s*\)/);
        //         if (themeMatch) {
        //             extractedThemes[themeMatch[1]] = {
        //                 darkner: themeMatch[2].split(',').map(Number),
        //                 midtones: themeMatch[3].split(',').map(Number),
        //                 lightner: themeMatch[4].split(',').map(Number),
        //             };
        //         }
        //     });
        
        //     return extractedThemes;
        // }

        // let themes = parseScssThemes(document.getElementById("scssInput").value);


        let activeTheme, multiplayer, vintageOn, balancer;
        let white, gray100, gray300, gray400, gray500, gray800, gray900, black, blue;

        function calculateColors() {
            activeTheme = document.getElementById("activeTheme").value;
            multiplayer = document.getElementById("multiplayer").value;
            vintageOn = document.getElementById("vintageOn").checked;
            balancer = document.getElementById("balancer").value;

            const conditionMinMax = multiplayer < 2 ? 1 : multiplayer > 100 ? 100 : 1 * multiplayer;
            const multiplyerMinus = multiplayer * 0.4;
            const multiplyerPlus = multiplayer * 1.2;

            let [rD, gD, bD] = themes[activeTheme].darkner;
            let [rM, gM, bM] = themes[activeTheme].midtones;
            let [rL, gL, bL] = themes[activeTheme].lightner;

            const darkner = [rD + conditionMinMax, gD + conditionMinMax, bD + conditionMinMax];
            const midtones = [rM - conditionMinMax, gM - conditionMinMax, bM - conditionMinMax];
            const lightner = [rL / conditionMinMax, gL / conditionMinMax, bL / conditionMinMax];

            const vintageRed = (vintageOn ? midtones[0] / 4 : 0) + 99;
            const vintageGreen = (vintageOn ? midtones[1] / 4 : 0) + 99;
            const vintageBlue = (vintageOn ? midtones[2] / 4 : 0) + 99;
            const vintageRGB = [vintageRed, vintageGreen, vintageBlue];

            white = darkner.map(value => (value > 255 ? 255 : parseInt(value)));
            gray100 = [midtones[0] + (vintageOn ? vintageRed / 3 : 0), midtones[1] + (vintageOn ? vintageGreen / 3 : 0), midtones[2] + (vintageOn ? vintageBlue / 3 : 0)]
            .map(value => (value > 255 ? 255 : parseInt(value)));
            gray300 = [lightner[0] + (vintageOn ? vintageRed : 0), lightner[1] + (vintageOn ? vintageGreen : 0), lightner[2] + (vintageOn ? vintageBlue : 0)]
            .map(value => (value > 255 ? 255 : parseInt(value)));
            gray400 = [lightner[0] + (vintageOn ? vintageRed / multiplyerMinus : 0), lightner[1] + (vintageOn ? vintageGreen / multiplyerMinus : 0), lightner[2] + (vintageOn ? vintageBlue / multiplyerMinus : 0)]
            .map(value => (value > 255 ? 255 : parseInt(value)));
            gray500 = [lightner[0] + (vintageOn ? vintageRed / multiplyerPlus : 0), lightner[1] + (vintageOn ? vintageGreen / multiplyerPlus : 0), lightner[2] + (vintageOn ? vintageBlue / multiplyerPlus : 0)]
            .map(value => (value > 255 ? 255 : parseInt(value)));
            gray800 = [vintageRGB[0] + 161 + lightner[0], vintageRGB[1] + 210 + lightner[1], vintageRGB[2] + 122 + lightner[2]]
            .map(value => (value > 255 ? 255 : parseInt(value)));
            gray900 = vintageRGB.map(value => (value > 255 ? 255 : parseInt(value)));
            black = [lightner[0] + vintageRed, lightner[1] + vintageGreen, lightner[2] + vintageBlue]
            .map(value => (value > 255 ? 255 : parseInt(value)));
            blue = black.map(value => (value > 255 ? 255 : parseInt(value)));
        }

        calculateColors();

        const colors = { white, gray100, gray300, gray400, gray500, gray800, gray900, black, blue };

        function copyToClipboard() {

        }

        function displayCleanScss() {
            calculateColors();
            let cleanScssString = `
$white: rgb(${white});

$gray-100: rgb(${gray100});
$gray-300: rgb(${gray300});
$gray-400: rgb(${gray400});
$gray-500: rgb(${gray500});
$gray-800: rgb(${gray800});
$gray-900: rgb(${gray900});

$black: rgb(${black});

$blue: rgb(${blue});
            `
            return cleanScssString
        }
        function viewCleanScss() {
            // document.getElementById("cleanScssOutput").textContent = JSON.stringify(colors, null, 2);
            document.getElementById("cleanScssOutput").textContent = displayCleanScss();
        }
    </script>

</body>
</html>
